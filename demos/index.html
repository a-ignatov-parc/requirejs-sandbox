<!doctype html>
<html lang="en">
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<title>requrejs-sandbox demo</title>
		<link rel="stylesheet" type="text/css" href="../static/styles/css/main.css">
		<script src="../static/js/libs/require.min.js"></script>
		<script>
			requirejs.config({
				baseUrl: '../static/js/app',
				paths: {
					'sources': '../../../src',
					'backbone': '../libs/backbone',
					'jquery': '../libs/jquery/jquery.min',
					'underscore': '../libs/underscore.min'
				},
				shim: {
					underscore: {
						exports: '_'
					},
					backbone: {
						deps: ['underscore', 'jquery'],
						exports: 'Backbone'
					}
				}
			});

			requirejs(['views/workspace'], function(Workspace) {
				var workspace = new Workspace;
			});

			requirejs(['sources/requirejs-sandbox'], function(requrejsSandbox) {
				console.log('requirejs-sandbox api', requrejsSandbox);

				// Инициализируем песочницу и пытаемся загрузить в нее вью `workspace`.
				requrejsSandbox.set('DemoApp', {
					requireUrl: '../static/js/libs/require.min.js',
					callback: function(require) {
						// Конфигурируем require.js загруженный в песочнице.
						// 
						// [TODO] Подумать над тем как конфигурировать `require.js` в песочнице. 
						// Сейчас получается дублирование кода.
						require.config({
							baseUrl: '../static/js/app',
							paths: {
								'sources': '../../../src',
								'backbone': '../libs/backbone',
								'jquery': '../libs/jquery/jquery.min',
								'underscore': '../libs/underscore.min'
							},
							shim: {
								underscore: {
									exports: '_'
								},
								backbone: {
									deps: ['underscore', 'jquery'],
									exports: 'Backbone'
								}
							}
						});

						// Пытаемся загрузить в песочницу вью и инициализировать ее.
						require(['views/workspace'], function(Workspace) {
							var workspace = new Workspace;
						});
					}
				});
			});
		</script>
	</head>
	<body>
		<div class="b-content">
			Look in console for debug info
		</div>
	</body>
</html>
